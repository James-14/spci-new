<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="static/platform/css/bootstrap.css" />
    <link rel="stylesheet" href="static/platform/css/indexMenu/index.css" />
    <link rel="stylesheet" href="static/platform/css/common.css" />
    <link rel="stylesheet" href="static/platform/css/style.css" />
    <link rel="stylesheet" type="text/css" href="static/platform/css/nav.css" />
    <!-- 甘特图-->
    <link rel="stylesheet" href="static/codebase/dhtmlxgantt.css?v=6.0.0">
    <!--add new main css by lisong-->
    <link rel="stylesheet" href="static/platform/css/main_new.css" />
    <!--end-->
    <script src="static/platform/js/jquery-1.10.1.min.js"></script>
    <script src="static/platform/js/bootstrap.min.js"></script>
    <!-- 甘特图-->
    <script src="static/codebase/dhtmlxgantt.js?v=6.0.0"></script>
    <script src="static/codebase/ext/dhtmlxgantt_undo.js?v=6.0.0"></script>
    <script src="static/codebase/locale/locale_cn.js" charset="utf-8"></script>
    <link
            rel="shortcut icon"
            href="static/platform/image/Page_Logo.png"
            type="image/x-icon"
    />
    <title>智能施工</title>
</head>
<body>
<nav
        class="navbar navbar-default navbar-fixed-top"
        role="navigation"
        id="top"
>
    <div class="container-fluid" id="top-container">
        <div class="navbar-header" id="leftLogo">
            <button
                    type="button"
                    class="navbar-toggle"
                    data-toggle="collapse"
                    data-target="#rightNav"
            >
                <span class="sr-only">切换导航</span>
                <span class="icon-bar"></span> <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!--
              <a class="navbar-brand" href="/" id="logo"><img src="/static/platform/image/logo.png"></a>
            -->
            <a class="navbar-brand" href="http://127.0.0.1:8088/" id="logo"
            ><img src="static/platform/image/loaa_1_03.png" style="width: 190px"
            /></a>
        </div>
        <div class="collapse navbar-collapse" id="rightNav">
            <ul id="leftNav" class="nav navbar-nav navbar-right">
                <li class="mainNav"><a href="http://127.0.0.1:8088/">首页</a></li>
                <li class="mainNav dropdown">
                    <a href="http://127.0.0.1:8088/#">项目总览</a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="http://127.0.0.1:8088/project/center.html"
                            >项目总览</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/project/mgn/pandect-all"
                            >项目地图</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/productRequest/quality"
                            >质量分析</a
                            >
                        </li>
                    </ul>
                </li>
                <li class="mainNav dropdown">
                    <a href="http://127.0.0.1:8088/#">在线统计</a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="http://127.0.0.1:8088/component/build_search.html"
                            >构件查询</a
                            >
                        </li>
                    </ul>
                </li>
                <li class="mainNav">
                    <a href="http://127.0.0.1:8088/communication/online_listen"
                    >在线聆听</a
                    >
                </li>
                <li class="mainNav dropdown">
                    <a href="http://127.0.0.1:8088/#">切换角色</a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=6"
                            >项目经理</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=5"
                            >临时</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=1"
                            >超级管理员</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=7"
                            >业主</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=8"
                            >运输负责人</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=9"
                            >设计负责人</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=10"
                            >施工负责人</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=11"
                            >生产负责人</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=12"
                            >APP客户版</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/pt/changeRole?roleId=13"
                            >APP库管角色</a
                            >
                        </li>
                    </ul>
                </li>
                <li class="mainNav dropdown">
                    <a href="http://127.0.0.1:8088/#">子系统入口</a>
                    <ul class="dropdown-menu ">
                        <li>
                            <a
                                    href="http://123.206.47.43:8088/dologin.do?maxAccount=yanj"
                                    target="_blank"
                            >工厂在线PBIS系统</a
                            >
                        </li>
                        <li>
                            <a href="http://saas.rootcloud.com/">生产装备在线CMES系统</a>
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/waybill/wayBillStatistics"
                            >运输在线</a
                            >
                        </li>
                        <li><a href="http://127.0.0.1:8088/taji">塔机在线</a></li>
                    </ul>
                </li>
                <li class="mainNav dropdown">
                    <a
                            href="http://127.0.0.1:8088/#"
                            class="dropdown-toggle"
                            data-toggle="dropdown"
                            id="head"
                    >
                        <img src="static/platform/image/head1.png" />
                    </a>
                    <ul class="dropdown-menu" id="userDrop">
                        <li>
                            <a href="http://127.0.0.1:8088/#"
                            >项目经理<span id="userName">李松</span></a
                            >
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="http://127.0.0.1:8088/project/center.html"
                            >我的项目</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/project/projectMenu"
                            >创建项目</a
                            >
                        </li>
                        <li>
                            <a
                                    href="http://127.0.0.1:8088/project/ctl/designSchedule.html"
                            >项目计划</a
                            >
                        </li>
                        <li>
                            <a href="http://127.0.0.1:8088/productRequest/quality"
                            >质量追溯</a
                            >
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="http://127.0.0.1:8088/communication/corporate_task"
                            >我的消息<span class="badge" id="myMsg">1</span></a
                            >
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="http://127.0.0.1:8088/mgr/user_chpwd">修改密码</a>
                        </li>
                        <li><a href="http://127.0.0.1:8088/pt/logout">退出</a></li>
                    </ul>
                    <ul id="curName">
                        <li>项目经理</li>
                        <li>李松</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container-fluid project-index-top clearfix">
    <div class="project-index-top-title">
        <span>施工计划</span><span class="construction-top-span construction-top-model-span construction-top-span-select" label="gantt">甘特图</span><span label="model" class="construction-top-span">模型</span>
    </div>
    <div  class="construction-top-return">
        <input type="button" class="btn-default" value="保存">
        <input type="button" class="btn-default" value="清空">
        <input type="button" class="btn-default" value="导入">
        <input type="button" class="btn-default" value="导出">
            <span>
                <img src="static/platform/svg/qrcode.svg">二维码
            </span>
        <span>
                <img src="static/platform/svg/lefttriangle.svg">返回
            </span>
    </div>
</div>
<div class="container-fluid construction-mid-top">
<span class="construction-mid-top-firstsapn">
    <img src="static/platform/img/reply_u6001.png" onclick="gantt.undo()">
</span>
    <span class="construction-mid-top-othersapn">
    <img src="static/platform/img/replay_u5999.png" onclick="gantt.redo()">
</span>
    <span class="construction-mid-top-othersapn">
    <img src="static/platform/img/sort_by_alpha_u6000.png">
</span>
    <span class="construction-mid-top-othersapn">
    <img src="static/platform/img/u6002.png">
</span>
    <span class="construction-mid-top-othersapn">
    <img src="static/platform/img/u6003.png">
</span>
</div>
<div class="construction-mid-main">
    <div id="gantt_here" class="construction-mid-gantte"></div>
    <div class="construction-mid-model">
        <div class="construction-mid-model-desp">
            <img src="static/platform/img/u1874.png">
        </div>
    </div>
</div>
<footer class="w1f">
    <p class="w2f">
        Copyright © <span id="crtime">2012-2018</span> All Right Reserved
    </p>
</footer>

<script>
    var tasks={
        data:[
            {id:1, text:"样板房",process:"test", progress:0.0,start_date:"01-05-2016",end_date:"06-05-2016",},
            {id:2, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:3, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:4, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:5, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:6, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:7, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:8, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:9, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:10, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:11, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:12, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:13, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
            {id:14, text:"样板房",process:"test", duration:211, progress:0.0,start_date:"01-05-2016",end_date:"30-12-2016",},
        ],
        links:[
            {id:1, source:1, target:2, type:"1"},
            {id:2, source:1, target:3, type:"1"},
            {id:3, source:3, target:4, type:"1"},
            {id:4, source:4, target:5, type:"0"},
            {id:5, source:5, target:6, type:"0"}
        ]
    };
    $(function(){
        $('.construction-top-span').click(function(){
            $(this).addClass("construction-top-span-select");
            $(this).siblings().removeClass("construction-top-span-select");
            var label=$(this).attr("label");
            if(label=="gantt"){
                $(".construction-mid-model").first().hide();
            }
            else
            {
                $(".construction-mid-model").first().show();
            }
        });
        loadData();
    });

    //甘特图填充数据
    function loadData() {
        //修改X轴日期显示格式
        gantt.config.scale_unit = "day";
        gantt.config.step = 1;
        gantt.config.date_scale = "%M %d";
        //修改任务列表日期显示格式
        // gantt.config.xml_date = "%Y-%m-%d %H:%i";

        gantt.config.columns=[
            {name:"id",label:"序号" ,align: "center"},
            {name:"text",label:"名称",tree:true,width:150},
            {name:"process",label:"施工工序",align: "center"},
            {name:"duration",label:"工期",align: "center" },
            {name:"start_date", label:"计划开始", align: "center" },
            {name:"end_date",   label:"计划结束", align: "center" },
            // {name:"add", label:""}
        ];

        gantt.config.undo_steps=10;
        gantt.config.grid_width = 600;

        //添加事件
        gantt.attachEvent('onAfterTaskAdd',function (id,task) {
            var t=gantt.getTask(id);
            console.log(t);
        });

        //修改事件
        gantt.attachEvent('onAfterTaskUpdate',function (id,item) {
            var t=gantt.getTask(id);
            console.log(t);
        });

        //删除事件
        gantt.attachEvent('onAfterTaskDelete',function (id,item) {
            console.log(id);
            console.log(item);

        });

        gantt.init("gantt_here");
        gantt.parse(tasks);
    }
</script>

</body>
</html>
